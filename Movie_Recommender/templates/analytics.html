<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommendation Analytics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <div class="container" id="analyticsContainer">
        <header>
            <h1><i class="fas fa-chart-line"></i> Recommendation System Analytics</h1>
            <p>Monitoring performance metrics and user engagement</p>
        </header>

        <div id="errorMessage" style="display: none; background-color: #ffebee; color: #c62828; padding: 1rem; border-radius: 8px; margin: 1rem 0; text-align: center;"></div>

        <div class="analytics-container">
            <div class="analytics-header">
                <h2>System Performance</h2>
                <select id="timeRange">
                    <option value="day">Last 24 Hours</option>
                    <option value="week" selected>Last 7 Days</option>
                    <option value="month">Last 30 Days</option>
                    <option value="all">All Time</option>
                </select>
            </div>

            <div class="analytics-metrics">
                <div class="metric-card">
                    <div class="metric-title">Total Recommendations</div>
                    <div class="metric-value" id="totalRecommendations">0</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">Click-Through Rate</div>
                    <div class="metric-value" id="clickThroughRate">0%</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">Average Rating</div>
                    <div class="metric-value" id="averageRating">0</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-title">Rating Completion</div>
                    <div class="metric-value" id="ratingCompletion">0%</div>
                </div>
            </div>

            <div class="chart-section">
                <div class="chart-container">
                    <h3>Rating Distribution</h3>
                    <div class="chart-wrapper">
                        <canvas id="ratingDistributionChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>User Engagement</h3>
                    <div class="chart-wrapper">
                        <canvas id="engagementChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <h3>Top Rated Recommendations</h3>
                <table id="topMoviesTable">
                    <thead>
                        <tr>
                            <th>Movie Title</th>
                            <th class="text-center">Avg. Rating</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows will be added dynamically by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="action-links">
            <a href="/" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Recommendations
            </a>
        </div>

        <footer>
            <p>&copy; 2025 Movie Recommender | Powered by Flask and Machine Learning</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
</body>
</html>